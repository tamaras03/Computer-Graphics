import { Vector2 } from 'three';

<<<<<<< HEAD
class SelectionHelper {

	constructor( renderer, cssClassName ) {

=======
/**
 * A helper for {@link SelectionBox}.
 *
 * It visualizes the current selection box with a `div` container element.
 *
 * @three_import import { SelectionHelper } from 'three/addons/interactive/SelectionHelper.js';
 */
class SelectionHelper {

	/**
	 * Constructs a new selection helper.
	 *
	 * @param {(WebGPURenderer|WebGLRenderer)} renderer - The renderer.
	 * @param {string} cssClassName - The CSS class name of the `div`.
	 */
	constructor( renderer, cssClassName ) {

		/**
		 * The visualization of the selection box.
		 *
		 * @type {HTMLDivElement}
		 */
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499
		this.element = document.createElement( 'div' );
		this.element.classList.add( cssClassName );
		this.element.style.pointerEvents = 'none';

<<<<<<< HEAD
		this.renderer = renderer;

		this.startPoint = new Vector2();
		this.pointTopLeft = new Vector2();
		this.pointBottomRight = new Vector2();

		this.isDown = false;
		this.enabled = true;

		this.onPointerDown = function ( event ) {
=======
		/**
		 * A reference to the renderer.
		 *
		 * @type {(WebGPURenderer|WebGLRenderer)}
		 */
		this.renderer = renderer;

		/**
		 * Whether the mouse or pointer is pressed down.
		 *
		 * @type {boolean}
		 * @default false
		 */
		this.isDown = false;

		/**
		 * Whether helper is enabled or not.
		 *
		 * @type {boolean}
		 * @default true
		 */
		this.enabled = true;

		// private

		this._startPoint = new Vector2();
		this._pointTopLeft = new Vector2();
		this._pointBottomRight = new Vector2();

		this._onPointerDown = function ( event ) {
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499

			if ( this.enabled === false ) return;

			this.isDown = true;
<<<<<<< HEAD
			this.onSelectStart( event );

		}.bind( this );

		this.onPointerMove = function ( event ) {
=======
			this._onSelectStart( event );

		}.bind( this );

		this._onPointerMove = function ( event ) {
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499

			if ( this.enabled === false ) return;

			if ( this.isDown ) {

<<<<<<< HEAD
				this.onSelectMove( event );
=======
				this._onSelectMove( event );
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499

			}

		}.bind( this );

<<<<<<< HEAD
		this.onPointerUp = function ( ) {
=======
		this._onPointerUp = function ( ) {
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499

			if ( this.enabled === false ) return;

			this.isDown = false;
<<<<<<< HEAD
			this.onSelectOver();

		}.bind( this );

		this.renderer.domElement.addEventListener( 'pointerdown', this.onPointerDown );
		this.renderer.domElement.addEventListener( 'pointermove', this.onPointerMove );
		this.renderer.domElement.addEventListener( 'pointerup', this.onPointerUp );

	}

	dispose() {

		this.renderer.domElement.removeEventListener( 'pointerdown', this.onPointerDown );
		this.renderer.domElement.removeEventListener( 'pointermove', this.onPointerMove );
		this.renderer.domElement.removeEventListener( 'pointerup', this.onPointerUp );

	}

	onSelectStart( event ) {
=======
			this._onSelectOver();

		}.bind( this );

		this.renderer.domElement.addEventListener( 'pointerdown', this._onPointerDown );
		this.renderer.domElement.addEventListener( 'pointermove', this._onPointerMove );
		this.renderer.domElement.addEventListener( 'pointerup', this._onPointerUp );

	}

	/**
	 * Call this method if you no longer want use to the controls. It frees all internal
	 * resources and removes all event listeners.
	 */
	dispose() {

		this.renderer.domElement.removeEventListener( 'pointerdown', this._onPointerDown );
		this.renderer.domElement.removeEventListener( 'pointermove', this._onPointerMove );
		this.renderer.domElement.removeEventListener( 'pointerup', this._onPointerUp );

		this.element.remove(); // in case disposal happens while dragging

	}

	// private

	_onSelectStart( event ) {
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499

		this.element.style.display = 'none';

		this.renderer.domElement.parentElement.appendChild( this.element );

		this.element.style.left = event.clientX + 'px';
		this.element.style.top = event.clientY + 'px';
		this.element.style.width = '0px';
		this.element.style.height = '0px';

<<<<<<< HEAD
		this.startPoint.x = event.clientX;
		this.startPoint.y = event.clientY;

	}

	onSelectMove( event ) {

		this.element.style.display = 'block';

		this.pointBottomRight.x = Math.max( this.startPoint.x, event.clientX );
		this.pointBottomRight.y = Math.max( this.startPoint.y, event.clientY );
		this.pointTopLeft.x = Math.min( this.startPoint.x, event.clientX );
		this.pointTopLeft.y = Math.min( this.startPoint.y, event.clientY );

		this.element.style.left = this.pointTopLeft.x + 'px';
		this.element.style.top = this.pointTopLeft.y + 'px';
		this.element.style.width = ( this.pointBottomRight.x - this.pointTopLeft.x ) + 'px';
		this.element.style.height = ( this.pointBottomRight.y - this.pointTopLeft.y ) + 'px';

	}

	onSelectOver() {

		this.element.parentElement.removeChild( this.element );
=======
		this._startPoint.x = event.clientX;
		this._startPoint.y = event.clientY;

	}

	_onSelectMove( event ) {

		this.element.style.display = 'block';

		this._pointBottomRight.x = Math.max( this._startPoint.x, event.clientX );
		this._pointBottomRight.y = Math.max( this._startPoint.y, event.clientY );
		this._pointTopLeft.x = Math.min( this._startPoint.x, event.clientX );
		this._pointTopLeft.y = Math.min( this._startPoint.y, event.clientY );

		this.element.style.left = this._pointTopLeft.x + 'px';
		this.element.style.top = this._pointTopLeft.y + 'px';
		this.element.style.width = ( this._pointBottomRight.x - this._pointTopLeft.x ) + 'px';
		this.element.style.height = ( this._pointBottomRight.y - this._pointTopLeft.y ) + 'px';

	}

	_onSelectOver() {

		this.element.remove();
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499

	}

}

export { SelectionHelper };
