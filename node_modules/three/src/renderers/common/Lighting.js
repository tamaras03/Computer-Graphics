import { LightsNode } from '../../nodes/Nodes.js';
import ChainMap from './ChainMap.js';

const _defaultLights = /*@__PURE__*/ new LightsNode();
<<<<<<< HEAD

class Lighting extends ChainMap {

=======
const _chainKeys = [];

/**
 * This renderer module manages the lights nodes which are unique
 * per scene and camera combination.
 *
 * The lights node itself is later configured in the render list
 * with the actual lights from the scene.
 *
 * @private
 * @augments ChainMap
 */
class Lighting extends ChainMap {

	/**
	 * Constructs a lighting management component.
	 */
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499
	constructor() {

		super();

	}

<<<<<<< HEAD
=======
	/**
	 * Creates a new lights node for the given array of lights.
	 *
	 * @param {Array<Light>} lights - The render object.
	 * @return {LightsNode} The lights node.
	 */
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499
	createNode( lights = [] ) {

		return new LightsNode().setLights( lights );

	}

<<<<<<< HEAD
=======
	/**
	 * Returns a lights node for the given scene and camera.
	 *
	 * @param {Scene} scene - The scene.
	 * @param {Camera} camera - The camera.
	 * @return {LightsNode} The lights node.
	 */
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499
	getNode( scene, camera ) {

		// ignore post-processing

		if ( scene.isQuadMesh ) return _defaultLights;

<<<<<<< HEAD
		// tiled lighting

		const keys = [ scene, camera ];

		let node = this.get( keys );
=======
		_chainKeys[ 0 ] = scene;
		_chainKeys[ 1 ] = camera;

		let node = this.get( _chainKeys );
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499

		if ( node === undefined ) {

			node = this.createNode();
<<<<<<< HEAD
			this.set( keys, node );

		}

=======
			this.set( _chainKeys, node );

		}

		_chainKeys.length = 0;

>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499
		return node;

	}

}

export default Lighting;
