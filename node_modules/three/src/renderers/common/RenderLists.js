import ChainMap from './ChainMap.js';
import RenderList from './RenderList.js';

<<<<<<< HEAD
class RenderLists {

	constructor( lighting ) {

		this.lighting = lighting;

=======
const _chainKeys = [];

/**
 * This renderer module manages the render lists which are unique
 * per scene and camera combination.
 *
 * @private
 */
class RenderLists {

	/**
	 * Constructs a render lists management component.
	 *
	 * @param {Lighting} lighting - The lighting management component.
	 */
	constructor( lighting ) {

		/**
		 * The lighting management component.
		 *
		 * @type {Lighting}
		 */
		this.lighting = lighting;

		/**
		 * The internal chain map which holds the render lists.
		 *
		 * @type {ChainMap}
		 */
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499
		this.lists = new ChainMap();

	}

<<<<<<< HEAD
	get( scene, camera ) {

		const lists = this.lists;
		const keys = [ scene, camera ];

		let list = lists.get( keys );
=======
	/**
	 * Returns a render list for the given scene and camera.
	 *
	 * @param {Scene} scene - The scene.
	 * @param {Camera} camera - The camera.
	 * @return {RenderList} The render list.
	 */
	get( scene, camera ) {

		const lists = this.lists;

		_chainKeys[ 0 ] = scene;
		_chainKeys[ 1 ] = camera;

		let list = lists.get( _chainKeys );
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499

		if ( list === undefined ) {

			list = new RenderList( this.lighting, scene, camera );
<<<<<<< HEAD
			lists.set( keys, list );

		}

=======
			lists.set( _chainKeys, list );

		}

		_chainKeys.length = 0;

>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499
		return list;

	}

<<<<<<< HEAD
=======
	/**
	 * Frees all internal resources.
	 */
>>>>>>> 50c6784a0819c7177d83555e6a1624cb4553e499
	dispose() {

		this.lists = new ChainMap();

	}

}

export default RenderLists;
